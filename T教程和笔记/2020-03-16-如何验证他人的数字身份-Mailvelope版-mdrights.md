---
date: 2020-03-16
author: MDrights
---

# 如何验证他人的数字身份（Mailvelope版）


> 前言：本文为作者本人经过自己实践和英文世界相关数字安全组织的资料/手册整合而成。若有错误或遗漏欢迎讨论和补充。

> 2020 更新：本文在[2019年版](https://github.com/mdrights/Digital-rights/blob/master/T%E6%95%99%E7%A8%8B%E5%92%8C%E7%AC%94%E8%AE%B0/2019-09-11-%E5%A6%82%E4%BD%95%E9%AA%8C%E8%AF%81%E4%BB%96%E4%BA%BA%E7%9A%84%E6%95%B0%E5%AD%97%E8%BA%AB%E4%BB%BD-mdrights.md)的基础上更新，且尽量写得更简易，在数字签名方面更容易操作，（且更注重在非电邮方面的使用）。

## 背景

有很多时候，我们 activist 在网络进行敏感的信息交流时不但需要加强信息的加密，验证对方的身份同样重要。PGP 是非常可靠的技术（包括它的相关工具），但至今它大多用在邮件方面，现在我们尝试在非邮件领域使用 PGP 作身份的验证。




## 威胁模式（Threat Model）

关于身份验证的威胁模式分析，可以参见[2019年版](https://github.com/mdrights/Digital-rights/blob/master/T%E6%95%99%E7%A8%8B%E5%92%8C%E7%AC%94%E8%AE%B0/2019-09-11-%E5%A6%82%E4%BD%95%E9%AA%8C%E8%AF%81%E4%BB%96%E4%BA%BA%E7%9A%84%E6%95%B0%E5%AD%97%E8%BA%AB%E4%BB%BD-mdrights.md)。  


## 验证数字身份的几种方法

让我们从易到难地讲开：

### 方法0 声音辨识法
这个肯定是最容易上手的了。  
优点：人声唯一性高，只要线下认识这个人，基本都能靠声识人。  
缺点：1）如果没听过对方的声音，则无法辨别；2）现在有的软件有变声功能……   

### 方法1 Signal 的安全号码
Signal 有个功能「验证安全号码」（verfiy safety number）——当与他人在私聊界面点击TA的人名（或电话号码）进入对方页面，即可查看你跟对方的这一串号码（经过密码学方法生成，你和对方的是相同的，且全世界只有你和对方相同，这样就保证了你沟通的就是TA（的设备），不是别人（的设备）。但要双方确认这安全号码是相同的，最好是线下面对面确认（Signal 也提供了二维码可以互相扫）。当然也可以通过其他方式如电话，或其他IM（但就不够严谨了）。

优点：用户友好，易于使用。
局限：这个方法本质上验证的还是TA所持有的设备（手机），及其上面安装的 Signal。如果设备丢失或被坏人拿去使用或被黑客攻入，这种验证就失败了。其实甚至只要TA重装了 Signal app 或系统，或者只是退出重新登录，这个安全码就变更了，需要双方重新验证。

### 方法2 PGP 密钥签名
这是目前最可靠的验证方法了，也是本文的重点。  
openPGP 是一种开源的密码学加密技术（公钥-私钥非对称加密），基本有两种用法：  

- 对方就可以用你给出的公钥发加密邮件给你，从密码学上保证只有你才能解密邮件（文件也可以这样操作）；
- 如果你的邮件或文件是用你的私钥签名的，对方也可以用你的公钥来验证这邮件或文件是你的。

所以，简而言之：

	公钥用于加密，私钥用于签名（方便记忆了吧）

以上就是 PGP 一般传统用法，下面我们来介绍不依赖邮件的 PGP 操作法，（基于邮件的操作请参考[2019年版](https://github.com/mdrights/Digital-rights/blob/master/T%E6%95%99%E7%A8%8B%E5%92%8C%E7%AC%94%E8%AE%B0/2019-09-11-%E5%A6%82%E4%BD%95%E9%AA%8C%E8%AF%81%E4%BB%96%E4%BA%BA%E7%9A%84%E6%95%B0%E5%AD%97%E8%BA%AB%E4%BB%BD-mdrights.md)）。

我们使用的平台和工具：
- 任何桌面操作系统
- 火狐 或 Chome浏览器
- Mailvelope （火狐和Chome浏览器插件）

----------

对，我们就用 [Mailvelope](https://www.mailvelope.com/)。网络上已经有不少关于 Mailvelope 的使用教学，比如[这篇](https://ithelp.ithome.com.tw/articles/10227574)就值得我们参考。以下步骤中的密钥生成部分（第1至4点）都可以直接参照该教程进行操作。

- 首先，点击「生成密钥」生成属于自己的公钥-私钥密钥对（这里输入的邮箱可以用来让朋友从一些公共服务器上找出你的公钥）；
	- 可以选择将公钥公开（比如可以在创建时勾选「上传到`Mailvelope`的服务器」或自行上传到其他一些公共的 key 服务器；然后在社交网络帐号上公开你的公钥指纹，或者直接把公钥指纹告诉给你的队友）；  
	- 不公开公钥也是可以的，你可以直接把公钥导出成`.asc`文件，以可靠的方式发给你的队友（当然最可靠的方式是面对面啦）。  

- 第二步我们要刚生成的私钥导出来，这很重要！！（当然也可以把公钥一起导出）
```
	密钥中的私钥，跟现实世界的钥匙一样，必须由自己保管，不可丢失、落入他人手中。
```
- 点击「导出」（`export`）

![](https://www.mailvelope.com/img/en_help/sucess_key_generation.png) 

- 删掉该密钥对（在「密钥管理」页面中的刚生成的密钥条目的右侧，点击「垃圾桶」图标）。
> 为什么要删掉？因为我们要让私钥保存在U盘等设备上。  
- 下次再使用时，只要再在「密钥管理」页面点击「导入」（`import`）按钮，把私钥传上去即可（它会自动再生成配对的公钥）。

![](https://www.mailvelope.com/img/en_help/no_keys.png) 

### 让别人验证我的身份

- 第三步，我们可以生成签名了。不过包括 Mailvelope 在内的大部分图形化工具都没有单独的签名界面，我们就用「加密」、「解密」界面吧。
> 但如果你能使用 Mailvelope 支持的邮件服务如 `Gmail`，在发邮件页面还是可以单独生成签名的。这里我们只讨论不依赖邮件的操作。

- 首先需要导入队友的公钥（方法与导入自己的私钥相同；公钥不必每次导出导入，可以一直留在电脑上）；
- 从U盘导入自己的私钥；
- 在「加密」页面，输入想要验证你身份的队友的邮箱（这个邮箱必须是队友公钥里的邮件地址）。最好也输入你自己的邮箱这样签名的内容自己也可以看到。
- 注意「收件人」框框下方的选项，一定要点击「改变」： `加密内容已签名（signed）`。
- 不用上传附件，但我们选择「加密一段文字」，在框框里随意写些文字。

- 点击右上角的「加密」按钮后，稍等片刻，即可出现加密（也是签名）后的密文（框框里`PGP MESSAGE`的内容）。
- 复制这个内容，就可以贴在任何即时通讯软件里啦。只要队友有你的公钥，就可以确认这是你发过来的内容！Hooray！
- 最后记得删除 Mailvelope 页面里自己的私钥。



### 验证别人的身份

- 首先需要导入队友的公钥（方法与导入自己的私钥相同；公钥不必每次导出导入，可以一直留在电脑上）；
- 从U盘导入自己的私钥；
- 队友从即时通讯软件上传来TA的带签名的密文，我们把它复制到剪贴板，粘贴到 Mailvelope 的「解密」页面里：
- 解密之后默认是生成一个明文的文本（`text.txt.asc`），但我们需要点击旁边的 Mailevlope 小logo ![](https://www.mailvelope.com/img/en_help/cryptography-icon16.png)，解密了的内容就可以在当前页面显示出来（并且这样才能验证对方的签名）。
- 如果在解密后的明文页面下方出现 `Digitally signed`（已数字签名）和队友的公钥 ID，那就是成功验证了队友，恭喜！
- 最后记得删除 Mailvelope 页面里自己的私钥。



## 总结一下

如果你阅读到这里，那么恭喜你！  

PGP 密钥签名是目前最可靠的验证他人数字身份的方法，大家（特别是需要经常进行敏感操作的朋友）应该把它用起来。  

还要强调一点：  

> PGP 私钥是非常私密的个人物品，妥善保管且要对其设置密码。建议在电脑上生成了密钥对之后，把私钥导出到一个USB盘上（当然这个U盘也可以加密），这个U盘就相当于你的钥匙，随身携带，用的时候插入电脑，不用时则拔出。电脑里则不再放这个私钥了以防电脑丢失或被坏人（如`popo`）冒用。

> **强烈建议**：不在手机（特别是安卓）上各种使用`PGP`密钥，最佳实践是敏感邮件就别在手机上收发了（当然若一定要使用也是有相关工具的）。原因很多，比如：手机设备更容易丢失或被冒用；安卓系统的令人担忧的安全性等等。


最后，请继续阅读：[PGP签名的最佳实践](https://github.com/mdrights/Digital-rights/blob/master/T%E6%95%99%E7%A8%8B%E5%92%8C%E7%AC%94%E8%AE%B0/2019-04-17-OpenPGP-%E6%95%B0%E5%AD%97%E7%AD%BE%E5%90%8D%E6%9C%80%E4%BD%B3%E5%AE%9E%E8%B7%B5-Mailfence.md)。

